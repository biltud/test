#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

# Read PORT from .env (if exists)
if [ -f .env ]; then
  PORT=$(grep "^PORT=" .env | cut -d "=" -f2)
else
  PORT=""
fi

# If PORT is not set in env → fallback to 3000 (same as main.ts)
if [ -z "$PORT" ]; then
  PORT=3000
fi

# Check final port value
if [ "$PORT" != "3005" ]; then
  echo "❌ Commit blocked!"
  echo "Your app port is $PORT but it must be 3005."
  exit 1
fi

echo "✔ PORT is 3005 — Commit allowed."
